
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="canonical" href="https://osg-htc.org/school-2025/materials/scaling/part1-ex2-composing-the-job/">
      
      <link rel="icon" href="../../../assets/OSG_Logo.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.1.0">
    
    
      
        <title>1.2 - Composing Your Jobs - OSG School 2025</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.33e2939f.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ef6f36e2.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../../stylesheets/code-highlight.css">
    
      <link rel="stylesheet" href="../../../stylesheets/osg.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("../../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#composing-your-jobs" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="OSG School 2025" class="md-header__button md-logo" aria-label="OSG School 2025" data-md-component="logo">
      
  <img src="../../../assets/OSG_Logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OSG School 2025
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              1.2 - Composing Your Jobs
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="OSG School 2025" class="md-nav__button md-logo" aria-label="OSG School 2025" data-md-component="logo">
      
  <img src="../../../assets/OSG_Logo.svg" alt="logo">

    </a>
    OSG School 2025
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../schedule/" class="md-nav__link">
        Schedule
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../health/" class="md-nav__link">
        Health Guidelines
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        Logistics
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Logistics" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Logistics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../logistics/" class="md-nav__link">
        General information
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../logistics/hotel/" class="md-nav__link">
        Hotel information
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../logistics/location/" class="md-nav__link">
        Location and transportation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../logistics/visas/" class="md-nav__link">
        Visa requirements
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../logistics/travel-planning/" class="md-nav__link">
        Travel planning
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../logistics/travel-advice/" class="md-nav__link">
        Travel advice
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../logistics/meals/" class="md-nav__link">
        Meal information
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../logistics/dining/" class="md-nav__link">
        Dining options
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../logistics/fun-day/" class="md-nav__link">
        Madison Fun Day
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../logistics/projects/" class="md-nav__link">
        Long-term OSPool access
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../logistics/assignment/" class="md-nav__link">
        Final assignment (Aug 1)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../logistics/reimbursements/" class="md-nav__link">
        Reimbursements (Aug 8)
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      <label class="md-nav__link" for="__nav_5">
        Materials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Materials" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Materials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_2" type="checkbox" id="__nav_5_2" >
      
      <label class="md-nav__link" for="__nav_5_2">
        Intro to HTCondor
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Intro to HTCondor" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_2">
          <span class="md-nav__icon md-icon"></span>
          Intro to HTCondor
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_2_1" type="checkbox" id="__nav_5_2_1" >
      
      <label class="md-nav__link" for="__nav_5_2_1">
        Intro Exercises 1 - Running and Viewing Simple Jobs
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Intro Exercises 1 - Running and Viewing Simple Jobs" data-md-level="3">
        <label class="md-nav__title" for="__nav_5_2_1">
          <span class="md-nav__icon md-icon"></span>
          Intro Exercises 1 - Running and Viewing Simple Jobs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../htcondor/part1-ex1-login/" class="md-nav__link">
        1.1 - Log in and look around
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../htcondor/part1-ex2-commands/" class="md-nav__link">
        1.2 - Experiment with HTCondor commands
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../htcondor/part1-ex3-jobs/" class="md-nav__link">
        1.3 - Run jobs!
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../htcondor/part1-ex4-logs/" class="md-nav__link">
        1.4 - Read and interpret log files
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../htcondor/part1-ex5-request/" class="md-nav__link">
        1.5 - Determine resource needs
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../htcondor/part1-ex6-remove/" class="md-nav__link">
        1.6 - Remove jobs from the queue
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_2_2" type="checkbox" id="__nav_5_2_2" >
      
      <label class="md-nav__link" for="__nav_5_2_2">
        Bonus Exercises - Job Attributes and Handling
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Bonus Exercises - Job Attributes and Handling" data-md-level="3">
        <label class="md-nav__title" for="__nav_5_2_2">
          <span class="md-nav__icon md-icon"></span>
          Bonus Exercises - Job Attributes and Handling
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../htcondor/part1-ex7-queue/" class="md-nav__link">
        Bonus Exercise 1.7 - Explore condor_q
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../htcondor/part1-ex8-status/" class="md-nav__link">
        Bonus Exercise 1.8 - Explore condor_status
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_2_3" type="checkbox" id="__nav_5_2_3" >
      
      <label class="md-nav__link" for="__nav_5_2_3">
        Intro Exercises 2 - Running Many HTC Jobs
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Intro Exercises 2 - Running Many HTC Jobs" data-md-level="3">
        <label class="md-nav__title" for="__nav_5_2_3">
          <span class="md-nav__icon md-icon"></span>
          Intro Exercises 2 - Running Many HTC Jobs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../htcondor/part2-ex1-files/" class="md-nav__link">
        2.1 - Work with input and output files
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../htcondor/part2-ex2-queue-n/" class="md-nav__link">
        2.2 - Use queue N, $(Cluster), and $(Process)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../htcondor/part2-ex3-queue-from/" class="md-nav__link">
        2.3 - Use queue from with custom variables
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../htcondor/part2-ex4-queue-matching/" class="md-nav__link">
        Bonus Exercise 2.4 - Use queue matching with a custom variable
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_3" type="checkbox" id="__nav_5_3" >
      
      <label class="md-nav__link" for="__nav_5_3">
        Researching the OSPool
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Researching the OSPool" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_3">
          <span class="md-nav__icon md-icon"></span>
          Researching the OSPool
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ospool/part1-ex1-where-run/" class="md-nav__link">
        1.1 - Where do jobs run?
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ospool/part1-ex2-capacity/" class="md-nav__link">
        1.2 - How much can I get?
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ospool/part1-ex3-dynamic-capacity/" class="md-nav__link">
        1.3 - How Does Capacity Change?
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ospool/part1-ex4-ep-sandbox/" class="md-nav__link">
        1.4 - What Is In an Execution Point?
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ospool/part1-ex5-ospool-views/" class="md-nav__link">
        Bonus Exercise 1.5 - Viewing OSPool Information
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_4" type="checkbox" id="__nav_5_4" >
      
      <label class="md-nav__link" for="__nav_5_4">
        Troubleshooting Exercises
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Troubleshooting Exercises" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_4">
          <span class="md-nav__icon md-icon"></span>
          Troubleshooting Exercises
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/part1-ex1-troubleshooting/" class="md-nav__link">
        1.1 - Troubleshooting Jobs
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/part1-ex2-job-retry/" class="md-nav__link">
        1.2 - Job Retry
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_5" type="checkbox" id="__nav_5_5" >
      
      <label class="md-nav__link" for="__nav_5_5">
        Software Exercises
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Software Exercises" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_5">
          <span class="md-nav__icon md-icon"></span>
          Software Exercises
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_5_1" type="checkbox" id="__nav_5_5_1" >
      
      <label class="md-nav__link" for="__nav_5_5_1">
        Software Exercises 1 - Exploring Containers
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Software Exercises 1 - Exploring Containers" data-md-level="3">
        <label class="md-nav__title" for="__nav_5_5_1">
          <span class="md-nav__icon md-icon"></span>
          Software Exercises 1 - Exploring Containers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../software/part1-ex1-run-apptainer/" class="md-nav__link">
        1.1 - Run and Explore Apptainer Containers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../software/part1-ex2-apptainer-jobs/" class="md-nav__link">
        1.2 - Use Apptainer Containers in OSPool Jobs
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../software/part1-ex3-docker-jobs/" class="md-nav__link">
        1.3 - Use Docker Containers in OSPool Jobs
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../software/part1-ex4-apptainer-build/" class="md-nav__link">
        1.4 - Build, Test, and Deploy an Apptainer Container
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../software/part1-ex5-pick-an-option/" class="md-nav__link">
        1.5 - Choose Software Options
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_5_2" type="checkbox" id="__nav_5_5_2" >
      
      <label class="md-nav__link" for="__nav_5_5_2">
        Software Exercises 2 - Preparing Scripts
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Software Exercises 2 - Preparing Scripts" data-md-level="3">
        <label class="md-nav__title" for="__nav_5_5_2">
          <span class="md-nav__icon md-icon"></span>
          Software Exercises 2 - Preparing Scripts
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../software/part2-ex1-build-executable/" class="md-nav__link">
        2.1 - Build an HTC-Friendly Executable
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_5_3" type="checkbox" id="__nav_5_5_3" >
      
      <label class="md-nav__link" for="__nav_5_5_3">
        Software Exercises 3 -  Container Examples (Optional)
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Software Exercises 3 -  Container Examples (Optional)" data-md-level="3">
        <label class="md-nav__title" for="__nav_5_5_3">
          <span class="md-nav__icon md-icon"></span>
          Software Exercises 3 -  Container Examples (Optional)
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../software/part3-ex1-apptainer-recipes/" class="md-nav__link">
        3.1 - Create an Apptainer Definition Files
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../software/part3-ex2-docker-build/" class="md-nav__link">
        3.2 - Build Your Own Docker Container
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_5_4" type="checkbox" id="__nav_5_5_4" >
      
      <label class="md-nav__link" for="__nav_5_5_4">
        Software Exercises 4 - Exploring Compiled Software (Optional)
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Software Exercises 4 - Exploring Compiled Software (Optional)" data-md-level="3">
        <label class="md-nav__title" for="__nav_5_5_4">
          <span class="md-nav__icon md-icon"></span>
          Software Exercises 4 - Exploring Compiled Software (Optional)
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../software/part4-ex1-download/" class="md-nav__link">
        4.1 - Download and Use Compiled Software
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../software/part4-ex2-wrapper/" class="md-nav__link">
        4.2 - Use a Wrapper Script To Run Software
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../software/part4-ex3-arguments/" class="md-nav__link">
        4.3 - Using Arguments With Wrapper Scripts
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_5_5" type="checkbox" id="__nav_5_5_5" >
      
      <label class="md-nav__link" for="__nav_5_5_5">
        Software Exercises 5 - Compiled Software Examples (Optional)
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Software Exercises 5 - Compiled Software Examples (Optional)" data-md-level="3">
        <label class="md-nav__title" for="__nav_5_5_5">
          <span class="md-nav__icon md-icon"></span>
          Software Exercises 5 - Compiled Software Examples (Optional)
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../software/part5-ex1-prepackaged/" class="md-nav__link">
        5.1 - Compiling a Research Software
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../software/part5-ex2-python/" class="md-nav__link">
        5.2 - Compiling Python and Running Jobs
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../software/part5-ex3-conda/" class="md-nav__link">
        5.3 - Using Conda Environments
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../software/part5-ex4-compiling/" class="md-nav__link">
        5.4 - Compiling and Running a Simple Code
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_6" type="checkbox" id="__nav_5_6" >
      
      <label class="md-nav__link" for="__nav_5_6">
        Data Exercises
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Data Exercises" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_6">
          <span class="md-nav__icon md-icon"></span>
          Data Exercises
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_6_1" type="checkbox" id="__nav_5_6_1" >
      
      <label class="md-nav__link" for="__nav_5_6_1">
        Data Exercises 1 - HTCondor File Transfer
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Data Exercises 1 - HTCondor File Transfer" data-md-level="3">
        <label class="md-nav__title" for="__nav_5_6_1">
          <span class="md-nav__icon md-icon"></span>
          Data Exercises 1 - HTCondor File Transfer
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../data/part1-ex1-data-needs/" class="md-nav__link">
        1.1 - Understanding a job's data needs
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../data/part1-ex2-file-transfer/" class="md-nav__link">
        1.2 - transfer_input_files, transfer_output_files, and remaps
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../data/part1-ex3-blast-split/" class="md-nav__link">
        1.3- Splitting input
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_6_2" type="checkbox" id="__nav_5_6_2" >
      
      <label class="md-nav__link" for="__nav_5_6_2">
        Data Exercises 2 - Using OSDF
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Data Exercises 2 - Using OSDF" data-md-level="3">
        <label class="md-nav__title" for="__nav_5_6_2">
          <span class="md-nav__icon md-icon"></span>
          Data Exercises 2 - Using OSDF
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../data/part2-ex1-osdf-inputs/" class="md-nav__link">
        2.1 - OSDF for inputs
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../data/part2-ex2-osdf-outputs/" class="md-nav__link">
        2.2 - OSDF for outputs
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_7" type="checkbox" id="__nav_5_7" checked>
      
      <label class="md-nav__link" for="__nav_5_7">
        Scaling Up
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Scaling Up" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_7">
          <span class="md-nav__icon md-icon"></span>
          Scaling Up
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_7_1" type="checkbox" id="__nav_5_7_1" checked>
      
      <label class="md-nav__link" for="__nav_5_7_1">
        Scaling Up - Organizing and Testing
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Scaling Up - Organizing and Testing" data-md-level="3">
        <label class="md-nav__title" for="__nav_5_7_1">
          <span class="md-nav__icon md-icon"></span>
          Scaling Up - Organizing and Testing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../part1-ex1-organization/" class="md-nav__link">
        1.1 - Organizing HTC workloads
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          1.2 - Composing Your Jobs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        1.2 - Composing Your Jobs
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#exercise-goal" class="md-nav__link">
    Exercise Goal
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#log-into-an-ospool-access-point" class="md-nav__link">
    Log into an OSPool Access Point
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generating-the-list-of-jobs" class="md-nav__link">
    Generating the List of Jobs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adapting-the-executable" class="md-nav__link">
    Adapting the Executable
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing-our-jobs-submit-a-test-list-of-jobs" class="md-nav__link">
    Testing Our Jobs - Submit a Test List of Jobs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#submit-multiple-jobs-scaling-to-full-dataset" class="md-nav__link">
    Submit Multiple Jobs - Scaling to Full Dataset
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#checking-your-jobs-progress" class="md-nav__link">
    Checking Your Jobs' Progress
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_7_2" type="checkbox" id="__nav_5_7_2" >
      
      <label class="md-nav__link" for="__nav_5_7_2">
        Exploring Resources
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Exploring Resources" data-md-level="3">
        <label class="md-nav__title" for="__nav_5_7_2">
          <span class="md-nav__icon md-icon"></span>
          Exploring Resources
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../part2-ex1-chtc-node/" class="md-nav__link">
        2.1 - Log Into a Local Pool
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../part2-ex2-hardware-diffs/" class="md-nav__link">
        2.2 - Hardware Differences Between OSPool and the CHTC Pool
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../part2-ex3-software-diffs/" class="md-nav__link">
        2.3 - Software Differences Between OSPool and the CHTC Pool
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_8" type="checkbox" id="__nav_5_8" >
      
      <label class="md-nav__link" for="__nav_5_8">
        DAGMan Exercises
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="DAGMan Exercises" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_8">
          <span class="md-nav__icon md-icon"></span>
          DAGMan Exercises
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../workflows/part1-ex1-simple-dag/" class="md-nav__link">
        1.1 - A simple DAG
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../workflows/part1-ex2-mandelbrot/" class="md-nav__link">
        1.2 - A brief detour through the Mandelbrot set
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../workflows/part1-ex3-complex-dag/" class="md-nav__link">
        1.3 - A more complex DAG
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../workflows/part1-ex4-failed-dag/" class="md-nav__link">
        1.4 - Handling jobs that fail with DAGMan
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../workflows/part1-ex5-challenges/" class="md-nav__link">
        1.5  - Workflow Challenges
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_9" type="checkbox" id="__nav_5_9" >
      
      <label class="md-nav__link" for="__nav_5_9">
        Self-checkpointing
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Self-checkpointing" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_9">
          <span class="md-nav__icon md-icon"></span>
          Self-checkpointing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../checkpoint/part1-ex1-checkpointing/" class="md-nav__link">
        1.1 - Trying out self-checkpointing
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_10" type="checkbox" id="__nav_5_10" >
      
      <label class="md-nav__link" for="__nav_5_10">
        Special Environments
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Special Environments" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_10">
          <span class="md-nav__icon md-icon"></span>
          Special Environments
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../special/part1-ex1-gpus/" class="md-nav__link">
        1.1 - GPUs
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#exercise-goal" class="md-nav__link">
    Exercise Goal
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#log-into-an-ospool-access-point" class="md-nav__link">
    Log into an OSPool Access Point
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generating-the-list-of-jobs" class="md-nav__link">
    Generating the List of Jobs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adapting-the-executable" class="md-nav__link">
    Adapting the Executable
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing-our-jobs-submit-a-test-list-of-jobs" class="md-nav__link">
    Testing Our Jobs - Submit a Test List of Jobs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#submit-multiple-jobs-scaling-to-full-dataset" class="md-nav__link">
    Submit Multiple Jobs - Scaling to Full Dataset
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#checking-your-jobs-progress" class="md-nav__link">
    Checking Your Jobs' Progress
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="composing-your-jobs">Composing Your Jobs<a class="headerlink" href="#composing-your-jobs" title="Permanent link">&para;</a></h1>
<h2 id="exercise-goal">Exercise Goal<a class="headerlink" href="#exercise-goal" title="Permanent link">&para;</a></h2>
<p>In our previous exercise, <a href="../part1-ex1-organization">Scaling-Up Exercise 1 Part 1</a>, we learned about the importance of preparing and organizing a directory structure for large-scale workloads. In this section, we'll learn strategies to compose and test these large-scale workloads in the form of jobs.</p>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>High throughput computing allows us to efficiently scale analyses by distributing jobs across many computing resources. In this lesson, we will continue the example from the previous exercise, now learning how to structure and submit a read mapping workflow using the OSPool and <code>minimap2</code>. This includes adapting your executable script and submit file to dynamically handle many input files in parallel.</p>
<div class="admonition danger">
<p class="admonition-title"><strong>Halt!</strong> Do not proceed if you haven't completed the <a href="../part1-ex1-organization">Scaling-Up Exercise 1 Part 1</a></p>
<p>This is part two of our Scaling Up Exercise 1 set and should <strong>only</strong> be completed after you've successfully completed <a href="../part1-ex1-organization">Scaling-Up Exercise 1 Part 1</a>. </p>
</div>
<h2 id="log-into-an-ospool-access-point">Log into an OSPool Access Point<a class="headerlink" href="#log-into-an-ospool-access-point" title="Permanent link">&para;</a></h2>
<p>Make sure you are logged into <code>ap40.uw.osg-htc.org</code>. </p>
<h2 id="generating-the-list-of-jobs">Generating the List of Jobs<a class="headerlink" href="#generating-the-list-of-jobs" title="Permanent link">&para;</a></h2>
<p>Next, we need to generate a list of jobs for HTCondor to run. In previous exercises, we've used the <code>queue</code> statements such as <code>queue &lt;num&gt;</code> and <code>queue &lt;variable&gt; matching *.txt</code>. </p>
<p>For our exercise, we will use the <code>queue &lt;var&gt; from &lt;list&gt;</code> submission strategy. </p>
<div class="admonition tip">
<p class="admonition-title">Think Ahead!</p>
<p>What values should we pass to HTCondor to scale our <code>minimap2</code> workflow up? </p>
</div>
<ol>
<li>
<p>Move to your <code>~/scaling-up/inputs/</code> directory</p>
<div class="codehilite"><pre><span></span><code>$ cd ~/scaling-up/inputs/
$ ls -la
total 11626328
drwxr-xr-x  2 username username 4096 Jun 13 16:08 .
drwx------ 10 username username 4096 Jun 13 16:07 ..
-rw-r--r--  1 username username   14 Jun 13 16:08 reads_fastq_chunk_a
-rw-r--r--  1 username username   14 Jun 13 16:08 reads_fastq_chunk_b
-rw-r--r--  1 username username   14 Jun 13 16:08 reads_fastq_chunk_c
-rw-r--r--  1 username username   14 Jun 13 16:08 reads_fastq_chunk_d
</code></pre></div>

</li>
<li>
<p>Make a list of all the files in <code>~/scaling-up/inputs/</code> and save it to <code>~/scaling-up/list_of_fastq.txt</code></p>
<div class="codehilite"><pre><span></span><code><span class="gp">$ </span>ls &gt; ~/scaling-up/list_of_fastq.txt
<span class="gp">$ </span><span class="nb">cd</span> ~/scaling-up/
<span class="gp">$ </span>ls -la
<span class="go">total 12</span>
<span class="go">drwxr-xr-x  2 username username 4096 Jun 13 16:08 .</span>
<span class="go">drwx------ 10 username username 4096 Jun 13 16:07 ..</span>
<span class="go">-rw-r--r--  1 username username   14 Jun 13 16:08 list_of_fastq.txt</span>
</code></pre></div>

</li>
<li>
<p>Use <code>head</code> to preview the first 10 lines of <code>list_of_fastq.txt</code></p>
<div class="codehilite"><pre><span></span><code><span class="gp">$ </span>head ~/scaling-up/list_of_fastq.txt
<span class="go">reads_fastq_chunk_aa</span>
<span class="go">reads_fastq_chunk_ab</span>
<span class="go">reads_fastq_chunk_ac</span>
<span class="go">reads_fastq_chunk_ad</span>
<span class="go">reads_fastq_chunk_ae</span>
<span class="go">...</span>
<span class="go">reads_fastq_chunk_aj</span>
</code></pre></div>

</li>
</ol>
<h2 id="adapting-the-executable">Adapting the Executable<a class="headerlink" href="#adapting-the-executable" title="Permanent link">&para;</a></h2>
<p>Now that we have our data partitioned into independent subsets to be mapped in parallel, we can work on adapting our executable for use on the OSPool. We will start with the following template executable file, which is also found in your project directory under <code>~/scaling-up/minimap2.sh</code>.</p>
<div class="codehilite"><pre><span></span><code><span class="gp">#</span>!/bin/bash
<span class="gp"># </span>Use minimap2 to map the basecalled reads to the reference genome
<span class="go">minimap2 -ax map-ont Celegans_ref.mmi reads.fastq &gt; output.sam</span>
</code></pre></div>

<table>
<thead>
<tr>
<th>Command Segment</th>
<th><code>minimap2</code></th>
<th><code>-ax map-ont</code></th>
<th><code>Celegans_ref.mmi</code></th>
<th><code>reads.fastq</code></th>
<th><code>&gt;</code></th>
<th><code>output.sam</code></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Meaning</strong></td>
<td>The program we'll run to map our reads</td>
<td>Specifies the type of reads we're using <br>(Oxford Nanopore Technologies reads)</td>
<td>The input reference we're mapping to</td>
<td>The reads we are mapping against our genome</td>
<td>redirects the output of minimap2 to a file</td>
<td>The output file of our mapping step</td>
</tr>
</tbody>
</table>
<div class="admonition danger">
<p class="admonition-title">Time-Out! <strong>Think about how you would adapt this executable template for HTC</strong></p>
<p>If we want to map each one of our reads subsets against the reference genome, think about the following questions:</p>
<ul>
<li>What parts of the command will change with each job?</li>
<li>What parts of the command will stay the same?</li>
</ul>
</div>
<p>Let's start by editing our template executable file! In our executable there's two main segments of the <code>minimap2</code> command that will be changed: The input <code>reads.fastq</code> file and the output <code>output.sam</code> file. </p>
<div class="admonition warning">
<p class="admonition-title">Thinking Ahead Before Errors! <strong>Renaming our output files</strong></p>
<p>What do you think would happen if we do keep the output file on our executable as <code>output.sam</code>?</p>
</div>
<ol>
<li>
<p>Modify the executable to accept the name of our input <code>reads.fastq</code> subsets as an argument.</p>
<div class="codehilite"><pre><span></span><code><span class="gp">#</span>!/bin/bash
<span class="go">reads_subset_file=&quot;$1&quot;</span>
<span class="gp"># </span>Use minimap2 to map the basecalled reads to the reference genome
<span class="go">minimap2 -ax map-ont Celegans_ref.mmi &quot;$reads_subset_file&quot; &gt; output.sam</span>
</code></pre></div>

</li>
<li>
<p>Modify the executable use the name of our input reads subset file (<code>$reads_subset_file</code>) as the prefix of our output file.</p>
<div class="codehilite"><pre><span></span><code><span class="gp">#</span>!/bin/bash
<span class="go">reads_subset_file=&quot;$1&quot;</span>
<span class="gp"># </span>Use minimap2 to map the basecalled reads to the reference genome
<span class="go">minimap2 -ax map-ont Celegans_ref.mmi &quot;$reads_subset_file&quot; &gt; &quot;${reads_subset_file}_output.sam&quot;</span>
</code></pre></div>

</li>
</ol>
<div class="admonition question">
<p class="admonition-title">Not sure how variables work on bash?</p>
<p>Reach out for help from one of the School staff members! You can also review the Software Carpentries' <a href="https://swcarpentry.github.io/shell-novice/05-loop.html">Unix Shell - Loops</a> tutorial for examples on how to use these variables in your daily computational use.</p>
</div>
<h2 id="testing-our-jobs-submit-a-test-list-of-jobs">Testing Our Jobs - Submit a Test List of Jobs<a class="headerlink" href="#testing-our-jobs-submit-a-test-list-of-jobs" title="Permanent link">&para;</a></h2>
<p>Now we want to submit a test job with our organizing scheme and adapted executable, using only a small set of our reads subset. We're going to start off with the multi-job submit template below. </p>
<div class="codehilite"><pre><span></span><code><span class="go">container_image         = &lt;path_to_sif&gt;</span>

<span class="go">executable              = &lt;path_to_executable&gt;</span>

<span class="go">transfer_input_files    = &lt;path_to_input_files&gt;</span>
<span class="go">transfer_output_files   = &lt;path_to_output_files&gt;</span>

<span class="go">log                     = &lt;path_to_log_file&gt;</span>
<span class="go">error                   = &lt;path_to_stderror_file&gt;</span>
<span class="go">output                  = &lt;path_to_stdout_file&gt;</span>

<span class="go">request_cpus            = &lt;num-of-cpus&gt;</span>
<span class="go">request_memory          = &lt;amount-of-memory&gt;</span>
<span class="go">request_disk            = &lt;amount-of-disk&gt;</span>

<span class="go">queue</span>
</code></pre></div>

<div class="admonition example">
<p class="admonition-title">Try It Yourself!</p>
<p>You've split your large FASTQ file into multiple read subsets, and you're ready to run <code>minimap2</code> on all of them in parallel. Before moving forward, check your understanding by trying to write the submit file yourself! Consider the following:</p>
<ol>
<li>What <code>queue</code> strategy discussed in the OSG School is best for our setup?<ul>
<li>Think about the List Of Jobs created in the <a href="#generating-the-list-of-jobs">Generating the List of Jobs</a> section</li>
</ul>
</li>
<li>How can we dynamically specify the <code>arguments</code>, <code>transfer_input_files</code>, <code>transfer_output_files</code> fields values with each <code>read_subset_file</code>.</li>
<li>Ensure your <code>log</code>, <code>error</code>, and <code>output</code> files all include the name of the read subset file being used mapped in this job.</li>
<li>Organize the output files using the correct <code>transfer_output_remaps</code> statement<ul>
<li>Remember, we want our output to be saved as <code>~/scaling-up/outputs/reads_fastq_chunk_a_output.sam</code> on the Access Point</li>
</ul>
</li>
<li>Which file transfer protocols should we use for our inputs/outputs?<ul>
<li>Consider whether these files are used one or repeatedly across all your jobs.</li>
</ul>
</li>
</ol>
<div class="admonition danger">
<p class="admonition-title">Try to Draft a Submit File Before Moving Forward</p>
</div>
</div>
<p>For our template, lets use <code>read_subset_file</code> as our variable name to pass the name of each subset file to.</p>
<ol>
<li>
<p>It is useful to think about constructing your submit file starting with the <code>queue</code> statement. This helps us predict how we need to structure our submit file in order to dynamically submit many jobs at once. </p>
<div class="admonition question">
<p class="admonition-title">What <code>queue</code> statement do you think would work best for our current workflow?</p>
<p>Consider the following:</p>
<ul>
<li>We have a set of FASTQ formatted reads_fastq_chunk_ subset files we need to submit along with each job.</li>
<li>Each reads_fastq_chunk_ subset file name is in our <code>~/scaling-up/list_of_fastq.txt</code> list of jobs.</li>
</ul>
<details class="success"><summary>Solution</summary><p>Since we have our list of job files saved in <code>~/scaling-up/list_of_fastq.txt</code>, we will use the <code>queue &lt;var&gt; from &lt;list_of_var.txt&gt;</code> syntax. </p>
<p><strong>Our queue statement will be:</strong></p>
<p><code>queue read_subset_file from ~/scaling-up/list_of_fastq.txt</code></p>
</details>
</div>
</li>
<li>
<p>Fill in the incomplete lines of the submit file, as shown below: </p>
<div class="codehilite"><pre><span></span><code><span class="go">container_image         = osdf:///ospool/ap40/data/&lt;user.name&gt;/scaling-up/software/minimap2.sif</span>

<span class="go">executable              = minimap2.sh</span>
<span class="go">arguments               = $(read_subset_file)</span>
</code></pre></div>

</li>
<li>
<p>Now, specify where the input and output files should be:</p>
<div class="codehilite"><pre><span></span><code><span class="go">transfer_input_files    = inputs/$(read_subset_file), osdf:///ospool/ap40/data/&lt;user.name&gt;/scaling-up/inputs/Celegans_ref.mmi</span>
<span class="go">transfer_output_files   = $(read_subset_file)_output.sam</span>
<span class="go">transfer_output_remaps  = &quot;$(read_subset_file)_output.sam=outputs/$(read_subset_file)_output.sam&quot;</span>
</code></pre></div>

<p>To tell HTCondor the location of the input file, we need to include the input directory.
Also, this submit file uses the <code>transfer_output_remaps</code> feature that you learned about;
it will move the output file to the <code>output</code> directory by renaming or remapping it.</p>
</li>
<li>
<p>Next, edit the submit file lines that tell the log, output, and error files where to go:</p>
<div class="codehilite"><pre><span></span><code><span class="go">output        = logs/output/job.$(ClusterID).$(ProcID)_$(read_subset_file)_output.out</span>
<span class="go">error         = logs/error/job.$(ClusterID).$(ProcID)_$(read_subset_file)_output.err</span>
<span class="go">log           = logs/log/job.$(ClusterID).$(ProcID)_$(read_subset_file)_output.log</span>
</code></pre></div>

</li>
<li>
<p>Add to the submit file your resource requirements:</p>
<div class="codehilite"><pre><span></span><code><span class="go">request_cpus           = 2</span>
<span class="go">request_disk           = 4 GB</span>
<span class="go">request_memory         = 4 GB</span>
</code></pre></div>

</li>
<li>
<p>Lastly, finish your submit file with the <code>queue</code> statement:</p>
<div class="codehilite"><pre><span></span><code>queue read_subset_file from ./test_list_of_fastq.txt
</code></pre></div>

<p>We will be using <code>./test_list_of_fastq.txt</code> instead while will only have a sample (3) of our reads subsets. We will use the fully scale list in the next section. </p>
<div class="admonition tip">
<p class="admonition-title">Thinking of our jobs as a <code>for</code> or <code>while</code> loop</p>
<p>We can think of our multi-job submission as a sort of <code>for</code> or <code>while</code> loop in bash.</p>
<div class="admonition success">
<p><strong>For Loop:</strong> If you are familiar with the <code>for</code> loop structure, imagine you wished to run the following loop:</p>
<div class="codehilite"><pre><span></span><code><span class="go">for read_subset_file in reads_fastq_chunk_a reads_fastq_chunk_b reads_fastq_chunk_c ... reads_fastq_chunk_z</span>
<span class="go">do</span>
<span class="go">    ./minimap2.sh $(read_subset_file)</span>
<span class="go">done</span>
</code></pre></div>

<p>In the example above, we would feed the list of FASTQ files in <code>~/scaling-up/inputs/</code> to the variable <code>$(read_subset_file)</code> as a list of strings. To express your jobs as a <code>for</code> loop in condor, we would instead use the <code>queue &lt;Var&gt; in &lt;List&gt;</code> syntax. In the example above, this would be represented as: </p>
<div class="codehilite"><pre><span></span><code>queue read_subset_file in (reads_fastq_chunk_a reads_fastq_chunk_b reads_fastq_chunk_c ... reads_fastq_chunk_z)
</code></pre></div>

</div>
<div class="admonition success">
<p><strong>While Loop:</strong> A closer representation to HTCondor's <em>list of jobs</em> structure is the <code>while</code> loop. If you are familiar with the <code>while</code> loop in bash, you could also consider the set of job submissions to mirror something like:</p>
<div class="codehilite"><pre><span></span><code><span class="go">while read read_subset_file;</span>
<span class="go">do</span>
<span class="go">    ./minimap2.sh $(read_subset_file)</span>
<span class="go">done &lt; list_of_fastq.txt</span>
</code></pre></div>

<p>Here we feed the contents of <code>list_of_fastq.txt</code>, the list of files in <code>~/scaling-up/inputs/</code> to the same <code>$(read_subset_file)</code> variable. The <code>while</code> loop iterates through each line of <code>list_of_fastq.txt</code>, appending the line's value to <code>$(read_subset_file)</code>. To express your jobs as a <code>for</code> loop in condor, we would instead use the <code>queue &lt;Var&gt; in &lt;List&gt;</code> syntax. In the example above, this would be represented as: </p>
<div class="codehilite"><pre><span></span><code>queue read_subset_file from ./list_of_files.txt
</code></pre></div>

</div>
<p>For jobs with more than 5 values, we generally recommend using the <code>queue var from list_of_files.txt</code> syntax. </p>
</div>
</li>
<li>
<p>Generate <code>./test_list_of_fastq.txt</code> using <code>head</code> command</p>
<div class="codehilite"><pre><span></span><code>head -n 3 ./list_of_fastq.txt &gt; ./test_list_of_fastq.txt
</code></pre></div>

</li>
<li>
<p>Submit your job and monitor its progress.</p>
<div class="admonition danger">
<p class="admonition-title">Remember to Check Your Submit File</p>
<p>A common reason your job may go on hold is forgetting to replace <code>&lt;user.name&gt;</code> with your OSPool username. Check your files and path are setup correctly. For example, your container_image path should look something like: <code>osdf:///ospool/ap40/data/daniel.morales/scaling-up/software/minimap2.sif</code>.</p>
</div>
<p>Submit your test job using <code>condor_submit</code></p>
<div class="codehilite"><pre><span></span><code><span class="go">condor_submit multi_job_minimap.sub</span>
</code></pre></div>

<p>Monitor the progress of your job using <code>condor_watch_q</code></p>
<div class="codehilite"><pre><span></span><code><span class="go">condor_watch_q</span>
</code></pre></div>

</li>
</ol>
<details class="success"><summary>Always Check Your Test Jobs Worked!</summary><p>Review your <code>condor_watch_q</code> output and your files on the Access Point. </p>
</details>
<h2 id="submit-multiple-jobs-scaling-to-full-dataset">Submit Multiple Jobs - Scaling to Full Dataset<a class="headerlink" href="#submit-multiple-jobs-scaling-to-full-dataset" title="Permanent link">&para;</a></h2>
<p>Now, you are ready to submit the whole workload. </p>
<div class="admonition example">
<p class="admonition-title">Try It Yourself!</p>
<p>You've split your large FASTQ file into multiple read subsets, and you're ready to run <code>minimap2</code> on all of them in parallel.</p>
<ol>
<li>Edit your submit file to use the <code>queue &lt;var&gt; from &lt;file&gt;</code> syntax.</li>
<li>Ensure the <code>arguments</code>, <code>transfer_input_files</code>, <code>transfer_output_files</code> fields change with each input.</li>
<li>Ensure your <code>log</code>, <code>error</code>, and <code>output</code> files all include the name of the read subset file being used mapped in this job.</li>
<li>Organize the output files using the correct <code>transfer_output_remaps</code> statement</li>
</ol>
<p><strong>Before submitting:</strong></p>
<ul>
<li>Are all your subset filenames listed in <code>list_of_fastq.txt</code>?<ul>
<li>Did you test at least one job successfully?</li>
<li>Are you remapping outputs into the <code>outputs/</code> folder?</li>
</ul>
</li>
</ul>
<p><strong>Think about what needs to change on your <code>multi_job_minimap.sub</code> submit file to submit the full dataset.</strong></p>
<p>When ready, submit with:
<code>condor_submit minimap2_multi.submit</code></p>
<details class="success"><summary>Solution -  Try to Solve Before Viewing </summary><p><strong>Make sure to change your <code>queue</code> statement to use the full dataset.</strong></p>
<p>Your final submit file, <code>minimap2_multi.submit</code>, should look something like this:</p>
<div class="codehilite"><pre><span></span><code>container_image      = osdf:///ospool/ap40/data/&lt;user.name&gt;/scaling-up/software/minimap2.sif

executable             = ./minimap2.sh
arguments              = $(read_subset_file)
transfer_input_files   = ./inputs/$(read_subset_file), osdf:///ospool/ap40/data/&lt;user.name&gt;/scaling-up/inputs/Celegans_ref.mmi

transfer_output_files  = ./$(read_subset_file)_output.sam
transfer_output_remaps = &quot;$(read_subset_file)_output.sam=outputs/$(read_subset_file)_output.sam&quot;

output                 = logs/output/job.$(ClusterID).$(ProcID)_$(read_subset_file)_output.out
error                  = logs/error/job.$(ClusterID).$(ProcID)_$(read_subset_file)_output.err
log                    = logs/log/job.$(ClusterID).$(ProcID)_$(read_subset_file)_output.log

request_cpus           = 2
request_disk           = 4 GB
request_memory         = 4 GB

queue read_subset_file from ./list_of_fastq.txt
</code></pre></div>

</details>
</div>
<h2 id="checking-your-jobs-progress">Checking Your Jobs' Progress<a class="headerlink" href="#checking-your-jobs-progress" title="Permanent link">&para;</a></h2>
<p>We can use the command <code>condor_watch_q</code> to track our job submission. As your jobs progress through the various <code>job state</code>, Condor will update the output of <code>condor_watch_q</code>.</p>
<div class="admonition tip">
<p class="admonition-title">Pro-Tip: Jobs Holds <em>Aren't</em> Always Bad!</p>
<p>Seeing your jobs in the Held state? Dont panic! This is often just HTCondor doing its job to protect your workflow.</p>
<p>Holds can happen for a variety of reasons: missing input files, typos in submit files, or temporary system issues. In many cases, these issues are transient and easily recoverable.</p>
<p><strong>To check why your job is held:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="go">condor_q -held</span>
</code></pre></div>

<p><strong>To release your held job after fixing the issue (e.g., typos or missing files):</strong>
[Not necessarily true. They'll need <code>condor_qedit</code> or resubmission]</p>
<div class="codehilite"><pre><span></span><code><span class="go">condor_release &lt;JobID&gt;</span>
</code></pre></div>

<p>If you're unsure whether to release or dig deeper, or if the hold message is crypticwere here to help! Reach out to the OSG Support team at <a href="mailto:support@osg-htc.org">support@osg-htc.org</a> with your job ID(s) and a brief description of what you're trying to do. Were always happy to assist.</p>
<p> <strong>Remember: held jobs are a signal, not a failure. Use them to improve and scale your workflows with confidence.</strong></p>
</div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../part1-ex1-organization/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              1.1 - Organizing HTC workloads
            </div>
          </div>
        </a>
      
      
        <a href="../part2-ex1-chtc-node/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              2.1 - Log Into a Local Pool
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
  <div class="md-footer-social">
    
      
      
      <a href="https://twitter.com/OSGSchool" target="_blank" rel="noopener" title="OSG School on Twitter" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../../assets/javascripts/workers/search.fe42c31b.min.js", "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.d892486b.min.js"></script>
      
    
  </body>
</html>